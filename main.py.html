<html>
<head>
<title>main.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #abb2bf;}
.s1 { color: #5c6370;}
.s2 { color: #c678dd;}
.s3 { color: #98c379;}
.s4 { color: #d19a66;}
</style>
</head>
<body bgcolor="#282c34">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
main.py</font>
</center></td></tr></table>
<pre>

<span class="s1">#################################################</span>
<span class="s1"># Welcome to our company valuation Python code !</span>
<span class="s1">#################################################</span>


<span class="s1">#  The following code is divided in two part.</span>
<span class="s1">#  Part 1 is about coding the GUI.</span>
<span class="s1">#  Part 2 is about the DCF model.</span>


<span class="s1">##################################</span>
<span class="s1"># Part 1: Coding the GUI</span>
<span class="s1">##################################</span>

<span class="s1"># As a first step, one should install the package tkinter, it enables us to simply create GUIs.</span>
<span class="s1"># Run the following line in the terminal:  &quot;pip install tk&quot;</span>

<span class="s1">#Imoprting the tkinter package. Rename it as tk.</span>

<span class="s2">import </span><span class="s0">tkinter </span><span class="s2">as </span><span class="s0">tk</span>

<span class="s1">#Creating a root widget to initialize tkinter</span>

<span class="s0">root = tk.Tk()</span>

<span class="s1"># Giving a title to our GUI and dimensions</span>

<span class="s0">root.title(</span><span class="s3">&quot;DCF Model GUI&quot;</span><span class="s0">)</span>
<span class="s0">root.geometry(</span><span class="s3">&quot;1400x700&quot;</span><span class="s0">)</span>


<span class="s1">#################</span>
<span class="s1"># Tkinter Labels</span>
<span class="s1">#################</span>

<span class="s1"># This section is about Labels. Labels are boxes of text that we can display on our GUIS.</span>
<span class="s1"># We can choose the font, the font style, and font size in the font section of the Label.</span>
<span class="s1"># When a label is created, we can use the grid function to position the object on the GUI.</span>
<span class="s1"># We inserted blank labels to create some spacing between objects on the screen. This is required</span>
<span class="s1"># because otherwise the objects would appear close to each others if no other objects are in the way.</span>

<span class="s1"># Here we create three labels by using the Label function. We then position them on the screen using the</span>
<span class="s1"># grid system. We can specify the row and the column where we want to place the object.</span>

<span class="s1"># Title Label</span>
<span class="s1"># We give our label a name (title_label). Then call the function Label from the package to create a label.</span>
<span class="s1"># The &quot;root&quot; word means we want to create the element in the initial root.</span>
<span class="s1"># We can specify the font by passing different parameters.</span>
<span class="s0">title_label = tk.Label(root, text=</span><span class="s3">&quot;Discounted Free Cash Flow Valuation Model&quot;</span><span class="s0">, font=(</span><span class="s3">&quot;calibre&quot;</span><span class="s0">, </span><span class="s4">20</span><span class="s0">, </span><span class="s3">&quot;bold&quot;</span><span class="s0">))</span>
<span class="s0">title_label.grid(row=</span><span class="s4">0</span><span class="s0">, column=</span><span class="s4">0</span><span class="s0">)</span>


<span class="s1">#Welcome Label</span>
<span class="s0">welcome_label = tk.Label(root, text=</span><span class="s3">&quot;Welcome to our python valuation model !&quot;</span><span class="s0">, font=(</span><span class="s3">&quot;calibre&quot;</span><span class="s0">, </span><span class="s4">13</span><span class="s0">))</span>
<span class="s0">welcome_label.grid(row=</span><span class="s4">1</span><span class="s0">, column=</span><span class="s4">0</span><span class="s0">)</span>


<span class="s1">#Blank number 0</span>
<span class="s0">blank = tk.Label(root, text=</span><span class="s3">&quot;                                &quot;</span><span class="s0">, font=(</span><span class="s3">&quot;calibre&quot;</span><span class="s0">, </span><span class="s4">20</span><span class="s0">, </span><span class="s3">&quot;bold&quot;</span><span class="s0">))</span>
<span class="s0">blank.grid(row=</span><span class="s4">2</span><span class="s0">, column=</span><span class="s4">0</span><span class="s0">)</span>


<span class="s1">#Ticker symbol Label</span>
<span class="s0">ticker_symbol_box = tk.Label(root, text=</span><span class="s3">&quot;1) Enter the ticker symbol (US stock):&quot;</span><span class="s0">, font=(</span><span class="s3">&quot;times new roman&quot;</span><span class="s0">, </span><span class="s4">14</span><span class="s0">))</span>
<span class="s0">ticker_symbol_box.grid(row=</span><span class="s4">6</span><span class="s0">, column=</span><span class="s4">0</span><span class="s0">)</span>


<span class="s1">#Blank number 1</span>
<span class="s0">blank_1 = tk.Label(root, text=</span><span class="s3">&quot;                        &quot;</span><span class="s0">, font=(</span><span class="s3">&quot;calibre&quot;</span><span class="s0">, </span><span class="s4">20</span><span class="s0">, </span><span class="s3">&quot;bold&quot;</span><span class="s0">))</span>
<span class="s0">blank_1.grid(row=</span><span class="s4">6</span><span class="s0">, column=</span><span class="s4">1</span><span class="s0">)</span>


<span class="s1">#Stock price output Label</span>
<span class="s0">output_stock_price = tk.Label(root, text=</span><span class="s3">&quot;Actual Stock Price: &quot;</span><span class="s0">, font=(</span><span class="s3">&quot;arial&quot;</span><span class="s0">, </span><span class="s4">14</span><span class="s0">))</span>
<span class="s0">output_stock_price.grid(row=</span><span class="s4">6</span><span class="s0">, column=</span><span class="s4">2</span><span class="s0">)</span>


<span class="s1">#Past growth Label</span>
<span class="s0">output_growth_rate_fcf = tk.Label(root, text=</span><span class="s3">&quot;4-yr growth rate of FCF: &quot;</span><span class="s0">, font=(</span><span class="s3">&quot;arial&quot;</span><span class="s0">, </span><span class="s4">14</span><span class="s0">))</span>
<span class="s0">output_growth_rate_fcf.grid(row=</span><span class="s4">7</span><span class="s0">, column=</span><span class="s4">2</span><span class="s0">)</span>


<span class="s1">#Future growth rate Label</span>
<span class="s0">future_growth_rate_fcf = tk.Label(root, text=</span><span class="s3">&quot;2) Future growth rate assumption of FCF in %: &quot;</span><span class="s0">, font=(</span><span class="s3">&quot;times new roman&quot;</span><span class="s0">, </span><span class="s4">14</span><span class="s0">))</span>
<span class="s0">future_growth_rate_fcf.grid(row=</span><span class="s4">16</span><span class="s0">, column=</span><span class="s4">0</span><span class="s0">)</span>


<span class="s1">#Discount rate Label</span>
<span class="s0">future_discount_rate = tk.Label(root, text = </span><span class="s3">&quot;Discount rate (desired returns) in %: &quot;</span><span class="s0">, font=(</span><span class="s3">&quot;times new roman&quot;</span><span class="s0">, </span><span class="s4">14</span><span class="s0">))</span>
<span class="s0">future_discount_rate.grid(row=</span><span class="s4">18</span><span class="s0">, column=</span><span class="s4">0</span><span class="s0">)</span>


<span class="s1">#Blank number 2</span>
<span class="s0">blank_2 = tk.Label(root, text= </span><span class="s3">&quot;            &quot;</span><span class="s0">, font=(</span><span class="s3">&quot;calibre&quot;</span><span class="s0">, </span><span class="s4">20</span><span class="s0">, </span><span class="s3">&quot;bold&quot;</span><span class="s0">))</span>
<span class="s0">blank_2.grid(row=</span><span class="s4">13</span><span class="s0">, column=</span><span class="s4">2</span><span class="s0">)</span>


<span class="s1">#Calculated value Label</span>
<span class="s0">output_intrinsic_value = tk.Label(root, text=</span><span class="s3">&quot;Intrinsic Value: &quot;</span><span class="s0">, font=(</span><span class="s3">&quot;arial&quot;</span><span class="s0">, </span><span class="s4">14</span><span class="s0">))</span>
<span class="s0">output_intrinsic_value.grid(row= </span><span class="s4">14</span><span class="s0">, column=</span><span class="s4">2</span><span class="s0">)</span>


<span class="s1">#Output potential Label</span>
<span class="s0">output_upside_potential = tk.Label(root, text=</span><span class="s3">&quot;Upside potential: &quot;</span><span class="s0">, font=(</span><span class="s3">&quot;arial&quot;</span><span class="s0">, </span><span class="s4">14</span><span class="s0">))</span>
<span class="s0">output_upside_potential.grid(row=</span><span class="s4">16</span><span class="s0">, column=</span><span class="s4">2</span><span class="s0">)</span>

<span class="s1"># All the texts elements are now displayed on the screen.</span>



<span class="s1">#################</span>
<span class="s1"># Tkinter Inputs</span>
<span class="s1">#################</span>

<span class="s1"># Here we create and position the user input elements.</span>
<span class="s1"># User input are created by using the entry function.</span>
<span class="s1"># We can vary the width of the entry box by changing the number.</span>
<span class="s1"># Same as for labels, we can position the element by using the grid</span>
<span class="s1"># function.</span>

<span class="s1">#Ticker symbol from user's input</span>
<span class="s0">input_ticker_symbol = tk.Entry(root, width=</span><span class="s4">12</span><span class="s0">)</span>
<span class="s0">input_ticker_symbol.grid(row=</span><span class="s4">6</span><span class="s0">, column=</span><span class="s4">1</span><span class="s0">)</span>


<span class="s1">#Future growth rate from user's input</span>
<span class="s0">input_future_growth_rate = tk.Entry(root, width=</span><span class="s4">12</span><span class="s0">)</span>
<span class="s0">input_future_growth_rate.grid(row=</span><span class="s4">16</span><span class="s0">, column=</span><span class="s4">1</span><span class="s0">)</span>


<span class="s1">#Discount rate from user's input</span>
<span class="s0">input_discount_rate = tk.Entry(root, width=</span><span class="s4">12</span><span class="s0">)</span>
<span class="s0">input_discount_rate.grid(row=</span><span class="s4">18</span><span class="s0">, column=</span><span class="s4">1</span><span class="s0">)</span>



<span class="s1"># The GUI is almost done.</span>
<span class="s1"># We still need to add three buttons.</span>
<span class="s1"># We need to define functions to tell the buttons what to do when</span>
<span class="s1"># they are clicked on. Thus, we will first define our functions</span>
<span class="s1"># and then create and place our buttons on the screen.</span>







<span class="s1">##################################</span>
<span class="s1"># Part 2: Coding the DCF Model</span>
<span class="s1">##################################</span>


<span class="s1"># In this part, we define the two functions needed for our buttons.</span>
<span class="s1"># Function 1 retrieves the stock price and the past growth.</span>
<span class="s1"># Function 2 computes the equity value per share.</span>


<span class="s1"># API requirements</span>
<span class="s1"># We import requests and pandas, they will be used</span>
<span class="s1"># when communicating with API. We define our API key.</span>

<span class="s2">import </span><span class="s0">requests</span>
<span class="s2">import </span><span class="s0">pandas </span><span class="s2">as </span><span class="s0">pd</span>
<span class="s0">key = </span><span class="s3">&quot;04871ed7089e320af811c91614b80420&quot;</span>


<span class="s1"># We define those two variables outside the functions.</span>
<span class="s1"># They will be used as global variables so the second function</span>
<span class="s1"># does need to call the API again for the same data.</span>

<span class="s0">cash_2020 = </span><span class="s4">0</span>
<span class="s0">price_of_ticker = </span><span class="s4">0</span>






<span class="s1">#################</span>
<span class="s1"># Function 1</span>
<span class="s1">#################</span>


<span class="s1"># Function number 1 takes the user's input of the ticker symbol to look up the price of the stock and</span>
<span class="s1"># calculate the last 4-year growth of the free cash flows.</span>

<span class="s2">def </span><span class="s0">get_financial_data():</span>

    <span class="s1">#Retrieve the input of the user for the ticker symbol</span>
    <span class="s0">ticker = input_ticker_symbol.get()</span>

    <span class="s1">#Convert it in upper case for the API</span>
    <span class="s0">ticker = ticker.upper()</span>

    <span class="s1">#Getting the price of the stock</span>
    <span class="s1">#We found the stock price in the API under the &quot;discounted-cash-flow&quot; document</span>
    <span class="s0">document = </span><span class="s3">&quot;discounted-cash-flow&quot;</span>

    <span class="s1">#Passing the parameters in the url</span>
    <span class="s0">url = </span><span class="s3">&quot;https://financialmodelingprep.com/api/v3/{}/{}?&amp;apikey={}&quot;</span><span class="s0">.format(document, ticker, key)</span>
    <span class="s0">r = requests.get(url)</span>

    <span class="s1">#We transform the dictionary data into a dataframe, and transpose for easier readability.</span>
    <span class="s0">price = pd.DataFrame.from_dict(r.json()).transpose()</span>

    <span class="s1">#Shift the first row as a column</span>
    <span class="s0">price.columns = price.iloc[</span><span class="s4">0</span><span class="s0">]</span>

    <span class="s1">#We ignore the first row</span>
    <span class="s0">price = price.iloc[</span><span class="s4">1</span><span class="s0">:]</span>

    <span class="s1">#Making the price_of_ticker a global variable so the second function does not have to</span>
    <span class="s1">#do an API call again.</span>
    <span class="s2">global </span><span class="s0">price_of_ticker</span>

    <span class="s1">#We locate the price data and round it</span>
    <span class="s0">price_of_ticker = price.iloc[</span><span class="s4">2</span><span class="s0">][</span><span class="s4">0</span><span class="s0">]</span>
    <span class="s0">price_of_ticker = round(price_of_ticker, </span><span class="s4">2</span><span class="s0">)</span>

    <span class="s1">#We create a label and position it on the screen. The price will now be displayed on the GUI.</span>
    <span class="s0">price_label = tk.Label(root, text=str(price_of_ticker), font=(</span><span class="s3">&quot;times new roman&quot;</span><span class="s0">, </span><span class="s4">14</span><span class="s0">))</span>
    <span class="s0">price_label.grid(row=</span><span class="s4">6</span><span class="s0">, column=</span><span class="s4">3</span><span class="s0">)</span>







    <span class="s1">#Here we will display on the screen the last 4-yr growth of the free cash flows</span>


    <span class="s1"># We need to retrieve the past cash flows.</span>
    <span class="s1"># his data can be found under the cash flow statements of the API</span>
    <span class="s1">#Those are almost the same steps as above but with different parameters.</span>
    <span class="s1">#We get the data from the API, transpose it and convert it to a dataframe.</span>
    <span class="s0">document_cashflow = </span><span class="s3">&quot;cash-flow-statement&quot;</span>
    <span class="s0">url_2 = </span><span class="s3">&quot;https://financialmodelingprep.com/api/v3/{}/{}?&amp;apikey={}&quot;</span><span class="s0">.format(document_cashflow, ticker, key)</span>
    <span class="s0">r2 = requests.get(url_2)</span>
    <span class="s0">cf_statement = pd.DataFrame.from_dict(r2.json()).transpose()</span>
    <span class="s0">cf_statement.columns = cf_statement.iloc[</span><span class="s4">0</span><span class="s0">]</span>
    <span class="s0">cf_statement = cf_statement.iloc[</span><span class="s4">1</span><span class="s0">:]</span>

    <span class="s1">#We store the cash flows in the variable cash_flows</span>
    <span class="s0">cash_flows = cf_statement.loc[</span><span class="s3">&quot;freeCashFlow&quot;</span><span class="s0">]</span>

    <span class="s1">#We make the free cash flow of 2020 a global variable so the second function can</span>
    <span class="s1">#directly use it.</span>
    <span class="s2">global </span><span class="s0">cash_2020</span>
    <span class="s0">cash_2020 = cash_flows.iloc[</span><span class="s4">0</span><span class="s0">]</span>

    <span class="s1">#Here we create a try/except since some stocks have 6 years of data instead of 5 years.</span>
    <span class="s1">#This is to debug the mistake &quot;index out of bound&quot;.</span>
    <span class="s2">try</span><span class="s0">:</span>
        <span class="s0">cash_2016 = cash_flows.iloc[</span><span class="s4">5</span><span class="s0">]</span>
    <span class="s2">except</span><span class="s0">:</span>
        <span class="s0">cash_2016 = cash_flows.iloc[</span><span class="s4">4</span><span class="s0">]</span>



    <span class="s1">#Here we use a formula to compute the average growth rate of the last 4 years.</span>
    <span class="s1">#We use the compound annual growth rate formula</span>
    <span class="s1">#We convert the cash to integer for the calculation, and format the results as percentage</span>
    <span class="s0">average_compound_growth = (((int(cash_2020) / int(cash_2016)) ** (</span><span class="s4">1 </span><span class="s0">/ </span><span class="s4">4</span><span class="s0">)) - </span><span class="s4">1</span><span class="s0">)*</span><span class="s4">100</span>

    <span class="s1">#We round the results to two decimals place.</span>
    <span class="s0">average_compound_growth = round(average_compound_growth, </span><span class="s4">2</span><span class="s0">)</span>

    <span class="s1">#We display the growth rate on the screen using label and grid. We add a &quot;%&quot; sign to our result.</span>
    <span class="s0">growth_label = tk.Label(root, text=str(average_compound_growth)+</span><span class="s3">&quot;%&quot;</span><span class="s0">, font=(</span><span class="s3">&quot;times new roman&quot;</span><span class="s0">, </span><span class="s4">14</span><span class="s0">))</span>
    <span class="s0">growth_label.grid(row=</span><span class="s4">7</span><span class="s0">, column=</span><span class="s4">3</span><span class="s0">)</span>

<span class="s1">#######################</span>
<span class="s1"># Button for function 1</span>
<span class="s1">#######################</span>


<span class="s1">#We use the button function of Tkinter. Under command, we precise which function to execute for our button.</span>
<span class="s1">#We also name our button &quot;Get Financial data&quot;. Using grid, we position our button. We choose the size with padx and</span>
<span class="s1">#pady. We selected a background color with bg.</span>
<span class="s0">button_get_data = tk.Button(root, text=</span><span class="s3">&quot;Get financial data&quot;</span><span class="s0">, command=get_financial_data, padx=</span><span class="s4">50</span><span class="s0">, pady=</span><span class="s4">8</span><span class="s0">, bg=</span><span class="s3">&quot;#89CFF0&quot;</span><span class="s0">)</span>
<span class="s0">button_get_data.grid(row=</span><span class="s4">7</span><span class="s0">, column=</span><span class="s4">0</span><span class="s0">)</span>





<span class="s1">#################</span>
<span class="s1"># Function 2</span>
<span class="s1">#################</span>

<span class="s1"># Function 2 computes the intrinsic value and displays it on the screen.</span>
<span class="s1"># To do this, the function needs the user assumptions about growth and discount rate.</span>
<span class="s1"># In term of financial data, the function needs the net debt, the cash position and</span>
<span class="s1"># the number of shares.</span>

<span class="s2">def </span><span class="s0">intrinsic_value():</span>

    <span class="s1">#We retrieve the input of the ticker symbol and put in upper case.</span>
    <span class="s1">#We retrieve this data by using the get function on our input label.</span>
    <span class="s0">ticker = input_ticker_symbol.get()</span>
    <span class="s0">ticker = ticker.upper()</span>

    <span class="s1">#We retrieve the user input regarding the growth rate.</span>
    <span class="s0">future_growth_rate = input_future_growth_rate.get()</span>

    <span class="s1">#we convert the input to int.</span>
    <span class="s0">future_growth_rate = int(future_growth_rate)</span>

    <span class="s1">#We convert the growth rate in decimals.</span>
    <span class="s0">future_growth_rate = future_growth_rate/</span><span class="s4">100</span>

    <span class="s1">#Retrieve, convert in int and in decimals to input discount rate.</span>
    <span class="s0">discount_rate = input_discount_rate.get()</span>
    <span class="s0">discount_rate = int(discount_rate)</span>
    <span class="s0">discount_rate = discount_rate/</span><span class="s4">100</span>

    <span class="s1">#Here we do the projections of FCF for the next 6-years.</span>
    <span class="s1">#This is based on the assumption of the user.</span>
    <span class="s0">cash_2021 = cash_2020 * (</span><span class="s4">1 </span><span class="s0">+ future_growth_rate)</span>
    <span class="s0">cash_2022 = cash_2021 * (</span><span class="s4">1 </span><span class="s0">+ future_growth_rate)</span>
    <span class="s0">cash_2023 = cash_2022 * (</span><span class="s4">1 </span><span class="s0">+ future_growth_rate)</span>
    <span class="s0">cash_2024 = cash_2023 * (</span><span class="s4">1 </span><span class="s0">+ future_growth_rate)</span>
    <span class="s0">cash_2025 = cash_2024 * (</span><span class="s4">1 </span><span class="s0">+ future_growth_rate)</span>
    <span class="s0">cash_2026 = cash_2025 * (</span><span class="s4">1 </span><span class="s0">+ future_growth_rate)</span>

    <span class="s1">#Here we discount each cash flow to obtain the present value.</span>
    <span class="s0">cash_discount_2021 = cash_2021 / (</span><span class="s4">1 </span><span class="s0">+ discount_rate)</span>
    <span class="s0">cash_discount_2022 = cash_2022 / ((</span><span class="s4">1 </span><span class="s0">+ discount_rate) ** </span><span class="s4">2</span><span class="s0">)</span>
    <span class="s0">cash_discount_2023 = cash_2023 / ((</span><span class="s4">1 </span><span class="s0">+ discount_rate) ** </span><span class="s4">3</span><span class="s0">)</span>
    <span class="s0">cash_discount_2024 = cash_2024 / ((</span><span class="s4">1 </span><span class="s0">+ discount_rate) ** </span><span class="s4">4</span><span class="s0">)</span>
    <span class="s0">cash_discount_2025 = cash_2025 / ((</span><span class="s4">1 </span><span class="s0">+ discount_rate) ** </span><span class="s4">5</span><span class="s0">)</span>
    <span class="s0">cash_discount_2026 = cash_2026 / ((</span><span class="s4">1 </span><span class="s0">+ discount_rate) ** </span><span class="s4">6</span><span class="s0">)</span>

    <span class="s1">#We sum each discounted cash flow.</span>
    <span class="s0">sum_of_discounted_free_cash_flow = cash_discount_2021 + cash_discount_2022 + \</span>
                                       <span class="s0">cash_discount_2023 + cash_discount_2024 + cash_discount_2025 + cash_discount_2026</span>

    <span class="s1">#We compute the terminal value. We assume 4% long term growth rate.</span>
    <span class="s1">#The following lines follow the terminal value formula.</span>
    <span class="s0">long_term_growth_rate = </span><span class="s4">0.04</span>
    <span class="s0">fcf_2026 = cash_2026*(</span><span class="s4">1</span><span class="s0">+long_term_growth_rate)</span>
    <span class="s0">terminal_value = fcf_2026/(discount_rate-long_term_growth_rate)</span>
    <span class="s0">terminal_value_discounted = terminal_value/((</span><span class="s4">1</span><span class="s0">+discount_rate)**</span><span class="s4">6</span><span class="s0">)</span>

    <span class="s1">#We then add upp the terminal value with the sum of discounted FCF to get the enterprise value.</span>
    <span class="s0">enterprise_value = sum_of_discounted_free_cash_flow + terminal_value_discounted</span>


    <span class="s1">#We know we need the net debt, cash position and the number of shares to find the equity value.</span>

    <span class="s1">#Here we ask the API to look at the balance sheet in order to retrieve the cash position and the net debt.</span>
    <span class="s1">#Similar as previous steps.</span>
    <span class="s0">document_balance_sheet = </span><span class="s3">&quot;balance-sheet-statement&quot;</span>
    <span class="s0">url_3 = </span><span class="s3">&quot;https://financialmodelingprep.com/api/v3/{}/{}?&amp;apikey={}&quot;</span><span class="s0">.format(document_balance_sheet, ticker, key)</span>
    <span class="s0">r3 = requests.get(url_3)</span>
    <span class="s0">balance_sheet = pd.DataFrame.from_dict(r3.json()).transpose()</span>
    <span class="s0">balance_sheet.columns = balance_sheet.iloc[</span><span class="s4">0</span><span class="s0">]</span>
    <span class="s0">balance_sheet = balance_sheet.iloc[</span><span class="s4">1</span><span class="s0">:]</span>

    <span class="s1">#We locate the cash and net debt item on the balance sheet.</span>
    <span class="s0">cash = balance_sheet.iloc[</span><span class="s4">7</span><span class="s0">][</span><span class="s4">0</span><span class="s0">]</span>
    <span class="s0">net_debt_2020 = balance_sheet.iloc[</span><span class="s4">48</span><span class="s0">][</span><span class="s4">0</span><span class="s0">]</span>


    <span class="s1">#Here we retrieve the number of shares from the API. The number of shares can be found in the enterprise value</span>
    <span class="s1">#document. The document, the ticker symbol, and our API key are passed as parameters.</span>
    <span class="s0">document_number_shares = </span><span class="s3">&quot;enterprise-values&quot;</span>
    <span class="s0">url_4 = </span><span class="s3">&quot;https://financialmodelingprep.com/api/v3/{}/{}?limit=40&amp;apikey={}&quot;</span><span class="s0">.format(document_number_shares, ticker,</span>
                                                                                       <span class="s0">key)</span>
    <span class="s0">r4 = requests.get(url_4)</span>

    <span class="s1">#Similar steps as before. Convert to dataframe. Move a row to a column.</span>
    <span class="s0">data_shares = pd.DataFrame.from_dict(r4.json()).transpose()</span>
    <span class="s0">data_shares.columns = data_shares.iloc[</span><span class="s4">0</span><span class="s0">]</span>
    <span class="s0">data_shares = data_shares.iloc[</span><span class="s4">1</span><span class="s0">:]</span>

    <span class="s1">#We more precisely find the number of shares outstanding.</span>
    <span class="s0">number_of_shares_outstanding = data_shares.loc[</span><span class="s3">&quot;numberOfShares&quot;</span><span class="s0">]</span>
    <span class="s0">number_shares_2020 = number_of_shares_outstanding.iloc[</span><span class="s4">0</span><span class="s0">]</span>

    <span class="s1">#In some cases we find the number of shares to be zero due to poor documents</span>
    <span class="s1"># if this is the case, we take the number of shares of last year.</span>

    <span class="s2">if </span><span class="s0">number_shares_2020 == </span><span class="s4">0</span><span class="s0">:</span>
        <span class="s0">number_shares_2020 = number_of_shares_outstanding.iloc[</span><span class="s4">1</span><span class="s0">]</span>



    <span class="s1">#We can finally compute the equity value by following the DCF formula.</span>
    <span class="s0">equity_value = enterprise_value - net_debt_2020 + cash</span>
    <span class="s0">equity_value_per_share = equity_value / number_shares_2020</span>

    <span class="s1">#We round the results to two decimals.</span>
    <span class="s0">equity_value_per_share = round(equity_value_per_share, </span><span class="s4">2</span><span class="s0">)</span>

    <span class="s1">#We create a label for the output to be displayed on the screen. We add a &quot;USD&quot; symbol for better</span>
    <span class="s1">#understanfding. Using grid, we positioned the element on the GUI screen.</span>
    <span class="s0">intrinsic_value_label = tk.Label(root, text=str(equity_value_per_share)+</span><span class="s3">&quot; USD&quot;</span><span class="s0">, font=(</span><span class="s3">&quot;times new roman&quot;</span><span class="s0">, </span><span class="s4">14</span><span class="s0">))</span>
    <span class="s0">intrinsic_value_label.grid(row=</span><span class="s4">14</span><span class="s0">, column=</span><span class="s4">3</span><span class="s0">)</span>

    <span class="s1">#We define an upside potential describing the potential gain in percentage between the calculated</span>
    <span class="s1">#value and the actual stock price. The upside potential is negative if the stock is overvalued.</span>
    <span class="s0">upside_potential = (equity_value_per_share / price_of_ticker) - </span><span class="s4">1</span>

    <span class="s1">#Put in percentage</span>
    <span class="s0">upside_potential = upside_potential*</span><span class="s4">100</span>

    <span class="s1">#Rounding to two decimals</span>
    <span class="s0">upside_potential = round(upside_potential, </span><span class="s4">2</span><span class="s0">)</span>

    <span class="s1">#Creating a label to display the upside potential as text. We convert the upside_potential into a string.</span>
    <span class="s0">upside_potential_label = tk.Label(root, text=str(upside_potential)+</span><span class="s3">&quot;%&quot;</span><span class="s0">, font=(</span><span class="s3">&quot;times new roman&quot;</span><span class="s0">, </span><span class="s4">14</span><span class="s0">))</span>
    <span class="s0">upside_potential_label.grid(row=</span><span class="s4">16</span><span class="s0">, column=</span><span class="s4">3</span><span class="s0">)</span>



<span class="s1">#######################</span>
<span class="s1"># Button for function 2</span>
<span class="s1">#######################</span>

<span class="s1">#Button for the function 2 to display the intrinsic value and the potential upside compared to the actual price.</span>
<span class="s1">#Using command we link the function and the button together. Padx, and pady are for the dimension of the button.</span>
<span class="s1">#Bg is for the background color of the button.</span>
<span class="s0">button_calculate_intrinsic_value = tk.Button(root, text=</span><span class="s3">&quot;Calculate the intrinsic value&quot;</span><span class="s0">, command=intrinsic_value,</span>
                                             <span class="s0">padx=</span><span class="s4">50</span><span class="s0">, pady=</span><span class="s4">8</span><span class="s0">, bg=</span><span class="s3">&quot;#89CFF0&quot;</span><span class="s0">)</span>

<span class="s1">#Postioning</span>
<span class="s0">button_calculate_intrinsic_value.grid(row=</span><span class="s4">20</span><span class="s0">, column=</span><span class="s4">0</span><span class="s0">)</span>


<span class="s1">#Blank label for spacing reasons</span>
<span class="s0">blank_3 = tk.Label(root, text=</span><span class="s3">&quot;            &quot;</span><span class="s0">, font=(</span><span class="s3">&quot;calibre&quot;</span><span class="s0">, </span><span class="s4">20</span><span class="s0">, </span><span class="s3">&quot;bold&quot;</span><span class="s0">))</span>
<span class="s0">blank_3.grid(row=</span><span class="s4">19</span><span class="s0">, column=</span><span class="s4">0</span><span class="s0">)</span>


<span class="s1">#Small button to quit the root GUI using the function quit.</span>
<span class="s0">button_quit = tk.Button(root, text=</span><span class="s3">&quot;Exit Program&quot;</span><span class="s0">, command=root.quit)</span>
<span class="s0">button_quit.grid(row=</span><span class="s4">20</span><span class="s0">, column=</span><span class="s4">3</span><span class="s0">)</span>


<span class="s1">#Create an infinite loop to display the GUI</span>
<span class="s0">root.mainloop()</span>


</pre>
</body>
</html>